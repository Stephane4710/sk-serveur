<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SK Serveur</title>

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:#0b0f17;
    color:#fff;
}

.container{width:90%;margin:auto;}

/* USER */
.user-box{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-top:15px;
    background:rgba(255,255,255,0.06);
    padding:12px 18px;
    border-radius:16px;
}

.logout-btn{
    border:none;
    padding:8px 14px;
    border-radius:10px;
    background:linear-gradient(135deg,#ff4e4e,#ff7676);
    color:#fff;
    font-weight:bold;
    cursor:pointer;
}

/* HEADER */
.top{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin:25px 0;
    position:relative;
}

.logo{
    font-size:22px;
    font-weight:bold;
}
.logo .sk{
    font-size:36px;
    color:#4e8cff;
}

.menu-btn{
    font-size:28px;
    cursor:pointer;
    padding:8px 14px;
    border-radius:10px;
    background:rgba(255,255,255,0.06);
}

/* MENU */
.menu-list{
    display:none;
    position:absolute;
    top:70px;
    right:0;
    background:#0f172a;
    border-radius:14px;
    padding:10px;
    min-width:200px;
    z-index:50;
}
.menu-list button{
    width:100%;
    background:none;
    border:none;
    color:#fff;
    padding:12px;
    cursor:pointer;
    text-align:left;
}
.menu-list.show{display:block;}

/* SEARCH */
.search{
    display:flex;
    gap:10px;
    margin-bottom:30px;
}
.search input{
    flex:1;
    padding:12px;
    border-radius:12px;
    border:none;
    background:#0f172a;
    color:#fff;
}
.search button{
    padding:12px 20px;
    border:none;
    border-radius:12px;
    background:#4e8cff;
    color:#fff;
}

/* SECTIONS */
.section{display:none;}
.section.active{display:block;}

/* GRID */
.cards-grid{
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:20px;
}

/* CARD */
.card{
    background:rgba(255,255,255,0.06);
    padding:16px;
    border-radius:16px;
    transition:.3s;
}
.card:hover{
    background:rgba(78,140,255,0.18);
    transform:translateY(-4px);
}

.card img{
    width:100%;
    max-height:180px;
    height:auto;
    object-fit:contain;
    background:#0f172a;
    border-radius:12px;
    margin-bottom:10px;
}

.price{color:#4e8cff;font-weight:bold;}
.small{font-size:13px;color:#b0b8c6;}

.btn-fonds{
    display:block;
    margin-top:15px;
    padding:12px;
    border-radius:12px;
    text-align:center;
    background:linear-gradient(135deg,#4e8cff,#2bd3ff);
    color:#fff;
    font-weight:bold;
    text-decoration:none;
}

.card{
    display:flex;
    flex-direction:column;
    height:100%;
}

.btn-fonds{
    margin-top:auto;
}


@media (max-width:1200px){
    .cards-grid{grid-template-columns:repeat(2,1fr);}
}
@media (max-width:768px){
    .cards-grid{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="container">

<!-- USER -->
<div class="user-box">
    <div>
        üë§ {{ user.username }} <br>
        üìß {{ user.email }}
    </div>
    <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button class="logout-btn">D√©connexion</button>
    </form>
</div>

<!-- HEADER -->
<div class="top">
    <div class="logo"><span class="sk">SK</span> Serveur</div>
    <div class="menu-btn" onclick="toggleMenu()">‚â°</div>

    <div class="menu-list" id="menuList">
        <button onclick="showSection('all')">Accueil</button>

        {% for cat in categories %}
            <button onclick="showSection('cat-{{ cat.id }}')">
                {{ cat.nom }}
            </button>
        {% endfor %}

        <button onclick="showSection('fonds')">Fonds</button>
        <button onclick="showSection('historique')">Historique</button>
    </div>
</div>

<form class="search" method="get">
    <input type="text" name="q" value="{{ query }}" placeholder="Rechercher un service">
    <button>Rechercher</button>
</form>

<!-- =======================
     ACCUEIL : TOUT
======================= -->
<div id="all" class="section active">
    {% for cat in categories %}
        <h2 style="margin-top:30px;color:#4e8cff;">{{ cat.nom }}</h2>

        <div class="cards-grid">
            {% for lic in cat.licences.all %}
            <div class="card">
                {% if lic.image %}
                <img src="{{ lic.image }}" alt="{{ lic.nom }}">
                {% endif %}
                <h3>{{ lic.nom }}</h3>
                <div class="price">{{ lic.prix }} FCFA</div>
                <div class="small">{{ lic.destription }}</div>
                <a href="{% url 'commande' 'licence' lic.id %}" class="btn-fonds">
                    üõí Commander
                </a>
            </div>
            {% endfor %}

            {% for s in cat.services.all %}
            <div class="card">
                <h3>{{ s.nom }}</h3>
                <div class="price">{{ s.prix }} FCFA</div>
                <div class="small">{{ s.destription }}</div>
                <a href="{% url 'commande' 'service' s.id %}" class="btn-fonds">
                    üõí Commander
                </a>
            </div>
            {% endfor %}
            {% for srv in cat.services_generaux.all %}
            <div class="card">
                {% if srv.image %}
                    <img src="{{ srv.image }}" alt="{{ srv.nom }}">
                {% endif %}
                <h3>{{ srv.nom }}</h3>
                <div class="price">{{ srv.prix }} FCFA</div>
                <div class="small">{{ srv.description }}</div>

                ‚úÖ <a href="{% url 'commande' 'service_general' srv.id %}" class="btn-fonds">
                    üõí Commander
                </a>
            </div>
             {% endfor %}

        </div>
    {% endfor %}
</div>

<!-- =======================
     PAR CAT√âGORIE
======================= -->
{% for cat in categories %}
<div id="cat-{{ cat.id }}" class="section">
    <h2>{{ cat.nom }}</h2>

    <div class="cards-grid">
        {% for lic in cat.licences.all %}
        <div class="card">
            {% if lic.image %}
            <img src="{{ lic.image }}" alt="{{ lic.nom }}">
            {% endif %}
            <h3>{{ lic.nom }}</h3>
            <div class="price">{{ lic.prix }} FCFA</div>
            <div class="small">{{ lic.destription }}</div>
            <a href="{% url 'commande' 'licence' lic.id %}" class="btn-fonds">
                üõí Commander
            </a>
        </div>
        {% endfor %}

        {% for s in cat.services.all %}
        <div class="card">
            <h3>{{ s.nom }}</h3>
            <div class="price">{{ s.prix }} FCFA</div>
            <div class="small">{{ s.destription }}</div>
            <a href="{% url 'commande' 'service' s.id %}" class="btn-fonds">
                üõí Commander
            </a>
        </div>
        {% endfor %}

        {% for srv in cat.services_generaux.all %}
    <div class="card">
        {% if srv.image %}
            <img src="{{ srv.image }}" alt="{{ srv.nom }}">
        {% endif %}
        <h3>{{ srv.nom }}</h3>
        <div class="price">{{ srv.prix }} FCFA</div>
        <div class="small">{{ srv.description }}</div>

        ‚úÖ <a href="{% url 'commande' 'service_general' srv.id %}" class="btn-fonds">
            üõí Commander
        </a>
    </div>
    {% endfor %}






    </div>
</div>
{% endfor %}

<!-- FONDS -->
<div id="fonds" class="section">
    <div class="card">
        <h3>Mon solde</h3>
        <div class="price">{{ wallet.solde }} FCFA</div>
        <a href="{% url 'fonds' %}" class="btn-fonds">‚ûï Ajouter des fonds</a>
    </div>
</div>

<!-- HISTORIQUE -->
<div id="historique" class="section">
    <h2>Historique & Commandes</h2>

    {% for c in commandes_attente %}
        <div class="card">
            <strong>{{ c.nom_produit }}</strong><br>
            <span class="price">{{ c.prix }} FCFA</span><br>
            <span class="small">‚è≥ En attente</span>
        </div>
    {% endfor %}

    {% for h in historiques %}
        <div class="card">
            <strong>{{ h.nom_service }}</strong><br>
            <span class="price">{{ h.prix }} FCFA</span><br>
            <span class="small">
                {% if h.statut == "succes" %}‚úÖ Succ√®s{% else %}‚ùå √âchec{% endif %}
            </span>
        </div>
    {% empty %}
        <div class="card">Aucune op√©ration</div>
    {% endfor %}
</div>

</div>

<script>
function toggleMenu(){
    document.getElementById("menuList").classList.toggle("show");
}
function showSection(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.getElementById("menuList").classList.remove("show");
}
</script>

</body>
</html>
